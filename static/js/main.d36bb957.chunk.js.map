{"version":3,"sources":["logic/wca-env.js","logic/auth.js","components/CubingIcon/CubingIcon.jsx","logic/formats.js","logic/utils.js","logic/countries.js","logic/wcif.js","logic/roundtypes.js","logic/events.js","components/Competition/CompetitionMenu/CompetitionMenu.jsx","logic/import-export-wcif.js","logic/scrambles.js","components/Scrambles/ScrambleList.jsx","components/Competition/RoundPanel/RoundPanel.jsx","components/Competition/CompetitionInfo/CompetitionDetailsPanel.jsx","components/Competition/CompetitionInfo/MatchingScramblesPanel.jsx","components/Scrambles/ScrambleFileInfo.jsx","components/Competition/CompetitionInfo/UploadedScramblesPanel.jsx","components/Competition/CompetitionInfo/CompetitionInfo.jsx","components/Competition/Competition.jsx","logic/results.js","logic/xlsx-utils.js","components/ImportWCIF/CompetitionsList.jsx","components/ImportWCIF/ImportWCIF.jsx","components/App/Header.jsx","components/App/Error.jsx","logic/wca-api.js","components/App/App.jsx","index.js"],"names":["searchParams","URLSearchParams","window","location","search","PRODUCTION","has","WCA_ORIGIN","WCA_OAUTH_CLIENT_ID","signIn","params","client_id","response_type","redirect_uri","oauthRedirectUri","scope","concat","toString","_window$location","origin","pathname","staging","get","appUri","replace","CubingIcon","_ref","eventId","props","Object","objectWithoutProperties","react_default","a","createElement","assign","style","fontSize","className","CubingIconUnofficial","_ref2","classnames","formats","id","name","shortName","solveCount","cutoffFormats","sortBy","formatById","find","format","updateArrayInplace","arr","index","newElem","updateIn","object","updater","toArray","property","properyChain","slice","length","Number","isInteger","objectSpread","defineProperty","flatMap","fn","reduce","xs","x","groupBy","obj","sortCompare","y","sort","sum","countries","wca_states","states_lists","list","states","countryById","country","parseActivityCode","activityCode","_activityCode$match","match","_activityCode$match2","slicedToArray","e","r","g","roundNumber","parseInt","groupNumber","attemptNumber","registrantIdFromAttributes","persons","countryId","wcaId","p","countryIso2","iso2","registrantId","competitionLink","eventHasValidScrambles","event","rounds","every","roundHasValidScrambles","round","includes","keys","scrambleSets","s","roundTypes","rank","cellName","isFinal","roundTypeById","t","events","eventNameById","propertyById","sortWcifEvents","wcifEvents","wcifEvent","findIndex","roundTypeIdForRound","numberOfRounds","roundTypeId","cutoff","useStyles","makeStyles","theme","nestedItem","paddingLeft","spacing","CompetitionMenu","setSelectedRound","_useState","useState","_useState2","selectedEvent","setSelectedEvent","classes","List","dense","ListItem","button","onClick","ListItemIcon","Info_default","ListItemText","primary","map","react","key","stopPropagation","CubingIcon_CubingIcon","Tooltip","title","ReportProblem_default","color","Collapse","in","timeout","unmountOnExit","uniqueScrambleSetId","uniqueScrambleUploadedId","getUniqueScrambleSetId","getUniqueScrambleUploadedId","internalWcifToResultsJson","wcif","version","personsToExport","toConsumableArray","Set","results","res","personId","formatVersion","competitionId","filter","gender","dob","birthdate","roundId","formatId","position","ranking","attempts","result","best","average","groups","scramblesToResultsGroups","internalScramblesToWcifScrambles","scrambleProgram","resultsProgram","internalWcifToWcif","importWcif","all","Math","max","apply","scrambleSheet","competitionName","generationUrl","generationDate","sheets","set","_scrambleSheet$sheets","internalSet","wcifScrambleToInternal","splitMultiFmAsWcif","push","extractedSheets","sheetName","scrambles","extraScrambles","prefixForIndex","sequence","generatedAttemptNumber","scrambleSetsForRound","usedScramblesId","uploadedScrambles","_parseActivityCode","firstMatchingSheets","up","numberOfAttempts","usedScramblesIdsForEvent","updateMultiAndFm","scramble","scrambleSetId","splitMultiFm","transformUploadedScrambles","uploadedJson","filename","sheet","tnoodleSheetsToInternal","String","fromCharCode","scramblesByAttempt","forEach","number","groupIndex","_sheets$groupIndex$sc","group","DNDList","styled","minHeight","ScrambleListHeader","Grid","item","md","lg","align","Typography","variant","ScrambleWithPrefix","prefix","subtitle","secondary","ScrambleItem","DraggableScramble","_ref3","showPrefix","react_beautiful_dnd_esm","draggableId","provided","snapshot","ref","innerRef","draggableProps","dragHandleProps","isDragging","draggableStyle","background","ScrambleList_ScrambleWithPrefix","ScrambleList_ScrambleItem","ScrambleList","_ref4","holds","startsWith","droppableId","droppableProps","ScrambleList_ScrambleListHeader","ScrambleList_DraggableScramble","placeholder","attemptFromDroppable","elem","split","ListForGenericRound","Paper","padding","Scrambles_ScrambleList","ListForAttemptBasedRound","nAttempts","Array","i","container","RoundPanel","_this","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","handleGenericMove","source","destination","_this$props","attachScramblesToRound","availableScrambles","state","splice","destScrambles","setState","handleAttemptBasedMove","_this$props2","destAttempt","k","handleScrambleMovement","prevProps","prevIds","join","_this$props3","onDragEnd","roundName","justify","RoundPanel_ListForAttemptBasedRound","RoundPanel_ListForGenericRound","Component","LinkToNewPage","block","extraProps","Link","target","rel","HelperWithLink","CompetitionDetailsPanel_LinkToNewPage","href","CompetitionDetailsPanel","downloadWcifAction","downloadResultsJsonAction","uploadCompetitionIdAction","exportAvailable","paper","gutterBottom","mb3","noValidate","autoComplete","TextField","label","value","onChange","ev","helperText","CompetitionDetailsPanel_HelperWithLink","margin","paragraph","ButtonGroup","aria-label","disabled","Button","MatchingScramblesPanel","assignAction","clearAction","uploadAction","direction","accept","input","multiple","type","htmlFor","component","fullWidth","addJsonButton","FreeBreakfast_default","extendedIcon","Delete_default","expand","transform","transition","transitions","create","duration","shortest","expandOpen","card","marginBottom","maxHeight","overflowY","ScrambleFileInfo","expanded","setExpanded","handleExpandClick","Card","CardActionArea","CardHeader","action","IconButton","clsx","aria-expanded","ExpandMore_default","titleTypographyProps","subheader","CardContent","UploadedScramblesPanel","Scrambles_ScrambleFileInfo","downloadFile","exporter","arguments","undefined","blob","Blob","JSON","stringify","blobURL","URL","createObjectURL","tmp","document","setAttribute","body","appendChild","click","display","marginTop","marginRight","CompetitionInfo","handleWcifChange","CompetitionInfo_CompetitionDetailsPanel","CompetitionInfo_MatchingScramblesPanel","usedScrambleIdsByEvent","autoAssignScrambles","clearScrambles","CompetitionInfo_UploadedScramblesPanel","Competition","handleOnBeforeUnload","preventDefault","returnValue","uploadNewScramble","reader","FileReader","onload","newScramble","parse","onerror","alert","files","readAsText","eventIndex","roundIndex","selectedRoundId","addEventListener","removeEventListener","_this$state","used","usedIds","allScramblesForEvent","Drawer","width","zIndex","PaperProps","Competition_CompetitionMenu_CompetitionMenu","flexGrow","RoundPanel_RoundPanel","Competition_CompetitionInfo_CompetitionInfo","timeInSecToValue","resultString","parseFloat","timeToValue","asMove","_resultString$split","_resultString$split2","min","rest","timeInMinutesToValue","formatStringToId","Format: best of 1","Format: best of 2","Format: best of 3","Format: mean of 3","Format: average of 5","Format: average of 5 (removing best and worst)","expectedNumberOfAttemptsByFormat","1","2","3","m","attemptsFromResultRow","row","maxAttempts","bestForRow","avgForRow","avgDetected","Error","some","meanFromAttempts","roundWcifFromXlsx","roundFormat","roundType","advancementCondition","scrambleSetCount","timeLimit","CompetitionsList","competitions","importFromCompetition","competition","CompetitionsSection","CompetitionsList_CompetitionsList","root","tabContent","loadSheetIntoWcif","jsonSheet","person","wcaUserId","registration","email","avatar","roles","assignments","personalBests","competitorLimit","qualification","xlsxOptions","header","raw","blankrows","Loading","CircularProgress","ImportWCIF","handleWcifJSONLoad","loading","signedIn","tabValue","setTabValue","xl","elevation","Tabs","Tab","ImportWCIF_Loading","CompetitionsList_CompetitionsSection","handleFileUploadChange","rABS","readAsBinaryString","wb","XLSX","read","sheetNames","SheetNames","schedule","utils","sheet_to_json","Sheets","readAsArrayBuffer","handleXlsxUploadChange","fontWeight","disablePadding","disableGutters","titleIcon","username","Header","user","AppBar","Toolbar","CubingIcon_CubingIconUnofficial","Avatar","src","thumb_url","icon","error","backgroundColor","palette","dark","message","alignItems","ErrorBar","clear","Snackbar","anchorOrigin","vertical","horizontal","open","SnackbarContent","aria-describedby","Close_default","getWcif","userToken","wcaApiFetch","path","fetchOptions","baseApiUrl","fetch","headers","Headers","Authorization","Content-Type","then","response","ok","statusText","json","App","_importWcif","_importWcif2","extractedScrambles","handleWcifUpdate","catch","_this2","getMe","me","oneMonthAgo","Date","now","managed_by_me","start","toISOString","getUpcomingManageableCompetitions","console","log","_this3","flexDirection","CssBaseline","App_Header","Competition_Competition","components_ImportWCIF_ImportWCIF","hash","hashParams","getOauthTokenIfAny","ReactDOM","render","App_App","getElementById"],"mappings":"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","file":"static/js/main.d36bb957.chunk.js","sourcesContent":["const searchParams = new URLSearchParams(window.location.search);\nexport const PRODUCTION =\n  process.env.NODE_ENV === 'production' && !searchParams.has('staging');\n\nexport const WCA_ORIGIN = PRODUCTION\n  ? 'https://www.worldcubeassociation.org'\n  : 'https://staging.worldcubeassociation.org';\n\nexport const WCA_OAUTH_CLIENT_ID = PRODUCTION\n  ? 'LdjkJPQlw4H19jf2HvCwIKk-ia1Ay_ExAFT0BlEy5Ts'\n  : 'example-application-id';\n","import { WCA_ORIGIN, WCA_OAUTH_CLIENT_ID } from './wca-env';\n\n/**\n * Checks the URL hash for presence of OAuth access token\n * and return it if it's found.\n * Should be called on application initialization (before any kind of router takes over the location).\n */\nexport const getOauthTokenIfAny = () => {\n  const hash = window.location.hash.replace(/^#/, '');\n  const hashParams = new URLSearchParams(hash);\n  if (hashParams.has('access_token')) {\n    window.location.hash = '';\n    return hashParams.get('access_token');\n  }\n  return null;\n};\n\nexport const signIn = () => {\n  const params = new URLSearchParams({\n    client_id: WCA_OAUTH_CLIENT_ID,\n    response_type: 'token',\n    redirect_uri: oauthRedirectUri(),\n    scope: 'public manage_competitions',\n  });\n  window.location = `${WCA_ORIGIN}/oauth/authorize?${params.toString()}`;\n};\n\nconst oauthRedirectUri = () => {\n  const { origin, pathname, search } = window.location;\n  const searchParams = new URLSearchParams(search);\n  const staging = searchParams.get('staging');\n  const appUri = `${origin}${pathname}`.replace(/\\/$/, '');\n  return staging ? `${appUri}?staging=true` : appUri;\n};\n","import React from 'react';\nimport classnames from 'classnames';\n\nexport const CubingIcon = ({ eventId, ...props }) => (\n  <span\n    style={{ fontSize: 24 }}\n    className={`cubing-icon event-${eventId}`}\n    {...props}\n  />\n);\n\nexport const CubingIconUnofficial = ({ eventId, className, ...props }) => (\n  <span\n    style={{ fontSize: 24 }}\n    className={classnames('cubing-icon', `unofficial-${eventId}`, className)}\n    {...props}\n  />\n);\n","const formats = [\n  {\n    id: '1',\n    name: 'Best of 1',\n    shortName: 'Bo1',\n    solveCount: 1,\n    cutoffFormats: [],\n    sortBy: 'best',\n  },\n  {\n    id: '2',\n    name: 'Best of 2',\n    shortName: 'Bo2',\n    solveCount: 2,\n    cutoffFormats: ['1'],\n    sortBy: 'best',\n  },\n  {\n    id: '3',\n    name: 'Best of 3',\n    shortName: 'Bo3',\n    solveCount: 3,\n    cutoffFormats: ['1', '2'],\n    sortBy: 'best',\n  },\n  {\n    id: 'm',\n    name: 'Mean of 3',\n    shortName: 'Mo3',\n    solveCount: 3,\n    cutoffFormats: ['1', '2'],\n    sortBy: 'average',\n  },\n  {\n    id: 'a',\n    name: 'Average of 5',\n    shortName: 'Ao5',\n    solveCount: 5,\n    cutoffFormats: ['1', '2', '3'],\n    sortBy: 'average',\n  },\n];\n\nexport const formatById = id => formats.find(format => format.id === id);\n","const updateArrayInplace = (arr, index, newElem) => {\n  arr[index] = newElem;\n  return arr;\n};\n\n/**\n * Returns a copy of the object with the value at the specified path transformed by the update function.\n *\n * @param {Object} object\n * @param {Array} propertyChain\n * @param {Function} updater\n * @returns {Object}\n */\nexport const updateIn = (object, [property, ...properyChain], updater) =>\n  properyChain.length === 0\n    ? Number.isInteger(property)\n      ? updateArrayInplace(object, property, updater(object[property]))\n      : { ...object, [property]: updater(object[property]) }\n    : Number.isInteger(property)\n    ? updateArrayInplace(\n        object,\n        property,\n        updateIn(object[property], properyChain, updater)\n      )\n    : {\n        ...object,\n        [property]: updateIn(object[property], properyChain, updater),\n      };\n\n/**\n * Returns a copy of the object with the value at the specified path set to the given one.\n *\n * @param {Object} object\n * @param {Array} propertyChain\n * @param {*} value\n * @returns {Object}\n */\nexport const setIn = (object, properyChain, value) =>\n  updateIn(object, properyChain, () => value);\n\n/**\n * Returns a copy of the object with the value at the specified path merged with the given one.\n *\n * @param {Object} object\n * @param {Array} propertyChain\n * @param {Object} newValue\n * @returns {Object}\n */\nexport const mergeIn = (object, properyChain, newValue) =>\n  updateIn(object, properyChain, currentValue => ({\n    ...currentValue,\n    ...newValue,\n  }));\n\n/**\n * Returns a copy of the object with the array at the specified path mapped with the given function.\n *\n * @param {Object} object\n * @param {Array} propertyChain\n * @param {Object} mapper\n * @returns {Object}\n */\nexport const mapIn = (object, properyChain, mapper) =>\n  updateIn(object, properyChain, array => array && array.map(mapper));\n\n/**\n * Returns object's value at the specified path or the default value if it doesn't exist.\n *\n * @param {Object} object\n * @param {Array} propertyChain\n * @param {*} defaultValue\n * @returns {*}\n */\nexport const getIn = (\n  object,\n  [property, ...propertyChain],\n  defaultValue = null\n) =>\n  object\n    ? propertyChain.length === 0\n      ? object.hasOwnProperty(property)\n        ? object[property]\n        : defaultValue\n      : getIn(object[property], propertyChain, defaultValue)\n    : defaultValue;\n\n/**\n * Checks if the given value is an object.\n *\n * @param {*} value\n * @returns {boolean}\n */\nconst isObject = obj => obj === Object(obj);\n\n/**\n * When given an object, deeply checks if it doesn't contain null values.\n * Otherwise, checks if the given value is not null.\n *\n * @param {*} value\n * @returns {boolean}\n */\nexport const isPresentDeep = value =>\n  isObject(value) ? Object.values(value).every(isPresentDeep) : value != null;\n\n/**\n * Pluralizes a word according to the given number.\n * When no plural form given, uses singular form with an 's' appended.\n *\n * @param {number} count\n * @param {string} singular\n * @param {string} plural\n * @returns {string}\n */\nexport const pluralize = (count, singular, plural) =>\n  `${count} ${count === 1 ? singular : plural || singular + 's'}`;\n\n/**\n * Returns a new array with items summing up to 1, preserving elements proportionality.\n * When the given array is empty, returns an empty array.\n *\n * @param {Array} arr\n * @returns {Array}\n */\nexport const scaleToOne = arr => {\n  if (arr.length === 0) return [];\n  const arrSum = sum(arr);\n  return arr.map(x => (arrSum !== 0 ? x / arrSum : 1 / arr.length));\n};\n\n/**\n * Applies the given function to the elements and returns the first truthy value of these calls.\n *\n * @param {Array} arr\n * @returns {*}\n */\nexport const firstResult = (arr, fn) =>\n  arr.reduce((result, x) => result || fn(x), null);\n\nexport const flatMap = (arr, fn) => arr.reduce((xs, x) => xs.concat(fn(x)), []);\n\nexport const groupBy = (arr, fn) =>\n  arr.reduce(\n    (obj, x) => updateIn(obj, [fn(x)], xs => (xs || []).concat(x)),\n    {}\n  );\n\nexport const zip = (...arrs) =>\n  arrs.length === 0 ? [] : arrs[0].map((_, i) => arrs.map(arr => arr[i]));\n\nexport const findLast = (arr, predicate) =>\n  arr.reduceRight(\n    (found, x) => (found !== undefined ? found : predicate(x) ? x : undefined),\n    undefined\n  );\n\nexport const intersection = (xs, ys) => xs.filter(x => ys.includes(x));\n\nexport const difference = (xs, ys) => xs.filter(x => !ys.includes(x));\n\nexport const partition = (xs, fn) => [xs.filter(fn), xs.filter(x => !fn(x))];\n\nconst sortCompare = (x, y) => (x < y ? -1 : x > y ? 1 : 0);\n\nexport const sortBy = (arr, fn) =>\n  arr.slice().sort((x, y) => sortCompare(fn(x), fn(y)));\n\nexport const sortByArray = (arr, fn) => {\n  const values = new Map(\n    arr.map(x => [x, fn(x)])\n  ); /* Compute every value once. */\n  return arr\n    .slice()\n    .sort((x, y) =>\n      firstResult(zip(values.get(x), values.get(y)), ([a, b]) =>\n        sortCompare(a, b)\n      )\n    );\n};\n\nexport const chunk = (arr, size) =>\n  arr.length <= size\n    ? [arr]\n    : [arr.slice(0, size), ...chunk(arr.slice(size), size)];\n\nexport const times = (n, fn) =>\n  Array.from({ length: n }, (_, index) => fn(index));\n\nexport const uniq = arr => [...new Set(arr)];\n\nexport const sum = arr => arr.reduce((x, y) => x + y, 0);\n\nexport const pick = (obj, keys) =>\n  keys.reduce((newObj, key) => ({ ...newObj, [key]: obj[key] }), {});\n\nexport const inRange = (x, a, b) => a <= x && x <= b;\n\nexport const addMilliseconds = (isoString, milliseconds) =>\n  new Date(new Date(isoString).getTime() + milliseconds).toISOString();\n\nexport const isoTimeDiff = (first, second) =>\n  Math.abs(new Date(first) - new Date(second));\n\nexport const shortTime = (isoString, timeZone = 'UTC') =>\n  new Date(isoString).toLocaleTimeString('en-US', {\n    timeZone,\n    hour: 'numeric',\n    minute: 'numeric',\n  });\n\nexport const reorderArray = (arr, from, to) => {\n  const [removed] = arr.splice(from, 1);\n  arr.splice(to, 0, removed);\n};\n","import { flatMap } from './utils';\nimport wca_states from '../wca_data/wca-states.json';\n\nconst countries = flatMap(wca_states.states_lists, list => list.states);\n\nexport const countryByIso2 = iso2 =>\n  countries.find(country => country.iso2 === iso2);\n\nexport const countryById = id => countries.find(country => country.id === id);\n","import { formatById } from './formats';\nimport { groupBy } from './utils';\nimport { countryById } from './countries';\n\nexport const parseActivityCode = activityCode => {\n  const [, e, r, g, a] = activityCode.match(\n    /(\\w+)(?:-r(\\d+))?(?:-g(\\d+))?(?:-a(\\d+))?/\n  );\n  return {\n    eventId: e,\n    roundNumber: r && parseInt(r, 10),\n    groupNumber: g && parseInt(g, 10),\n    attemptNumber: a && parseInt(a, 10),\n  };\n};\n\nexport const registrantIdFromAttributes = (persons, name, countryId, wcaId) =>\n  persons.find(\n    p =>\n      p.name === name &&\n      p.countryIso2 === countryById(countryId).iso2 &&\n      p.wcaId === wcaId\n  ).registrantId;\n\nexport const competitionLink = id =>\n  `https://www.worldcubeassociation.org/competitions/${id}`;\n\nexport const competitionHasValidScrambles = wcif =>\n  wcif.events.every(e => eventHasValidScrambles(e));\n\nexport const eventHasValidScrambles = event =>\n  event.rounds.every(r => roundHasValidScrambles(event.id, r));\n\nexport const roundHasValidScrambles = (eventId, round) =>\n  // Just taking eventId to avoid some splitting of round.id\n  ['333mbf', '333fm'].includes(eventId)\n    ? Object.keys(groupBy(round.scrambleSets, s => s.attemptNumber)).length ===\n      formatById(round.format).solveCount\n    : round.scrambleSets.length !== 0;\n","const roundTypes = [\n  {\n    id: '0',\n    rank: 19,\n    name: 'Qualification round',\n    cellName: 'Qualification',\n    isFinal: 0,\n  },\n  {\n    id: '3',\n    rank: 79,\n    name: 'Semi Final',\n    cellName: 'Semi Final',\n    isFinal: 0,\n  },\n  {\n    id: 'b',\n    rank: 39,\n    name: 'B Final',\n    cellName: 'B Final',\n    isFinal: 0,\n  },\n  {\n    id: 'c',\n    rank: 90,\n    name: 'Combined Final',\n    cellName: 'Combined Final',\n    isFinal: 1,\n  },\n  {\n    id: 'd',\n    rank: 20,\n    name: 'Combined First round',\n    cellName: 'Combined First',\n    isFinal: 0,\n  },\n  {\n    id: 'e',\n    rank: 59,\n    name: 'Combined Second round',\n    cellName: 'Combined Second',\n    isFinal: 0,\n  },\n  {\n    id: 'f',\n    rank: 99,\n    name: 'Final',\n    cellName: 'Final',\n    isFinal: 1,\n  },\n  {\n    id: 'g',\n    rank: 70,\n    name: 'Combined Third round',\n    cellName: 'Combined Third',\n    isFinal: 0,\n  },\n  {\n    id: '1',\n    rank: 29,\n    name: 'First round',\n    cellName: 'First',\n    isFinal: 0,\n  },\n  {\n    id: '2',\n    rank: 50,\n    name: 'Second round',\n    cellName: 'Second',\n    isFinal: 0,\n  },\n  {\n    id: 'h',\n    rank: 10,\n    name: 'Combined qualification',\n    cellName: 'Combined qualification',\n    isFinal: 0,\n  },\n];\n\nexport const roundTypeById = id => roundTypes.find(t => t.id === id);\n\nexport const roundTypeFromCellName = cellName =>\n  roundTypes.find(t => cellName.includes(t.cellName));\n","import { sortBy } from './utils';\nimport { parseActivityCode } from './wcif';\nimport { roundTypeById } from './roundtypes';\n\nconst events = [\n  { id: '333', name: '3x3x3 Cube', shortName: '3x3' },\n  { id: '222', name: '2x2x2 Cube', shortName: '2x2' },\n  { id: '444', name: '4x4x4 Cube', shortName: '4x4' },\n  { id: '555', name: '5x5x5 Cube', shortName: '5x5' },\n  { id: '666', name: '6x6x6 Cube', shortName: '6x6' },\n  { id: '777', name: '7x7x7 Cube', shortName: '7x7' },\n  { id: '333bf', name: '3x3x3 Blindfolded', shortName: '3BLD' },\n  { id: '333fm', name: '3x3x3 Fewest Moves', shortName: 'FMC' },\n  { id: '333oh', name: '3x3x3 One-Handed', shortName: '3OH' },\n  { id: '333ft', name: '3x3x3 With Feet', shortName: '3WF' },\n  { id: 'minx', name: 'Megaminx', shortName: 'Minx' },\n  { id: 'pyram', name: 'Pyraminx', shortName: 'Pyra' },\n  { id: 'clock', name: 'Clock', shortName: 'Clock' },\n  { id: 'skewb', name: 'Skewb', shortName: 'Skewb' },\n  { id: 'sq1', name: 'Square-1', shortName: 'Sq1' },\n  { id: '444bf', name: '4x4x4 Blindfolded', shortName: '4BLD' },\n  { id: '555bf', name: '5x5x5 Blindfolded', shortName: '5BLD' },\n  { id: '333mbf', name: '3x3x3 Multi-Blind', shortName: 'MBLD' },\n];\n\nexport const eventNameById = eventId => propertyById('name', eventId);\n\nexport const shortEventNameById = eventId => propertyById('shortName', eventId);\n\nconst propertyById = (property, eventId) =>\n  events.find(event => event.id === eventId)[property];\n\nexport const sortWcifEvents = wcifEvents =>\n  sortBy(wcifEvents, wcifEvent =>\n    events.findIndex(event => event.id === wcifEvent.id)\n  );\n\nexport const roundTypeIdForRound = (numberOfRounds, round) => {\n  // This is the case if we loaded a XLSX!\n  if (round.roundTypeId) return round.roundTypeId;\n\n  let { roundNumber } = parseActivityCode(round.id);\n  if (roundNumber === numberOfRounds) {\n    return round.cutoff ? 'c' : 'f';\n  }\n  if (roundNumber === 1) {\n    return round.cutoff ? 'd' : '1';\n  }\n  if (roundNumber === 2) {\n    return round.cutoff ? 'e' : '2';\n  }\n  if (roundNumber === 3) {\n    return round.cutoff ? 'g' : '3';\n  }\n  return '<oops>';\n};\n\nexport const roundName = (numberOfRounds, round) => {\n  let { eventId } = parseActivityCode(round.id);\n  return `${eventNameById(eventId)} - ${\n    roundTypeById(roundTypeIdForRound(numberOfRounds, round)).name\n  }`;\n};\n","import React, { Fragment, useState } from 'react';\nimport Collapse from '@material-ui/core/Collapse';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport { makeStyles } from '@material-ui/core/styles';\nimport InfoIcon from '@material-ui/icons/Info';\nimport ReportProblemIcon from '@material-ui/icons/ReportProblem';\n\nimport { CubingIcon } from '../../CubingIcon/CubingIcon';\nimport {\n  eventHasValidScrambles,\n  roundHasValidScrambles,\n} from '../../../logic/wcif';\nimport { eventNameById, roundTypeIdForRound } from '../../../logic/events';\nimport { roundTypeById } from '../../../logic/roundtypes';\n\nconst useStyles = makeStyles(theme => ({\n  nestedItem: {\n    paddingLeft: theme.spacing(4),\n  },\n}));\n\nconst CompetitionMenu = ({ events, setSelectedRound }) => {\n  const [selectedEvent, setSelectedEvent] = useState(null);\n  const classes = useStyles();\n  return (\n    <List dense={true}>\n      <ListItem\n        button\n        onClick={() => {\n          setSelectedEvent(null);\n          setSelectedRound(null);\n        }}\n      >\n        <ListItemIcon>\n          <InfoIcon />\n        </ListItemIcon>\n        <ListItemText primary=\"Information\" />\n      </ListItem>\n      {events.map(event => (\n        <Fragment key={event.id}>\n          <ListItem\n            button\n            onClick={e => {\n              setSelectedEvent(selectedEvent === event.id ? null : event.id);\n              e.stopPropagation();\n            }}\n          >\n            <ListItemIcon>\n              <CubingIcon eventId={event.id} />\n            </ListItemIcon>\n            <ListItemText primary={eventNameById(event.id)} />\n            {!eventHasValidScrambles(event) && (\n              <Tooltip title=\"Missing scrambles\">\n                <ReportProblemIcon color=\"error\" />\n              </Tooltip>\n            )}\n          </ListItem>\n          <Collapse\n            in={selectedEvent === event.id}\n            timeout=\"auto\"\n            unmountOnExit\n          >\n            <List dense={true}>\n              {event.rounds.map(round => (\n                <ListItem\n                  key={round.id}\n                  button\n                  className={classes.nestedItem}\n                  onClick={() => setSelectedRound(round.id)}\n                >\n                  <ListItemText\n                    primary={\n                      roundTypeById(\n                        roundTypeIdForRound(event.rounds.length, round)\n                      ).name\n                    }\n                  />\n                  {!roundHasValidScrambles(event.id, round) && (\n                    <Tooltip title=\"Missing scrambles\">\n                      <ReportProblemIcon color=\"error\" />\n                    </Tooltip>\n                  )}\n                </ListItem>\n              ))}\n            </List>\n          </Collapse>\n        </Fragment>\n      ))}\n    </List>\n  );\n};\n\nexport default CompetitionMenu;\n","import { internalScramblesToWcifScrambles } from './scrambles';\nimport {\n  scramblesToResultsGroups,\n  wcifScrambleToInternal,\n  splitMultiFmAsWcif,\n} from './scrambles';\nimport { flatMap, updateIn } from './utils';\nimport { sortWcifEvents, roundTypeIdForRound } from './events';\nimport { parseActivityCode } from './wcif';\n\nlet uniqueScrambleSetId = 1;\nlet uniqueScrambleUploadedId = 1;\n\nexport const getUniqueScrambleSetId = () => uniqueScrambleSetId++;\nexport const getUniqueScrambleUploadedId = () => uniqueScrambleUploadedId++;\n\nconst personIdsWithResults = events => [\n  ...new Set(\n    flatMap(events, e =>\n      flatMap(e.rounds, r => r.results.map(res => res.personId))\n    )\n  ),\n];\n\nexport const internalWcifToResultsJson = (wcif, version) => {\n  let personsToExport = personIdsWithResults(wcif.events);\n  return {\n    formatVersion: 'WCA Competition 0.3',\n    competitionId: wcif.id,\n    persons: wcif.persons\n      .filter(p => personsToExport.includes(p.registrantId))\n      .map(p => ({\n        id: p.registrantId,\n        name: p.name,\n        wcaId: p.wcaId || '',\n        countryId: p.countryIso2,\n        gender: p.gender || '',\n        dob: p.birthdate,\n      })),\n    events: wcif.events.map(e => ({\n      eventId: e.id,\n      rounds: e.rounds.map(r => ({\n        roundId: roundTypeIdForRound(e.rounds.length, r),\n        formatId: r.format,\n        results: r.results.map(res => ({\n          personId: res.personId,\n          position: res.ranking,\n          results: res.attempts.map(a => a.result),\n          best: res.best,\n          average: ['444bf', '555bf'].includes(e.id) ? 0 : res.average,\n        })),\n        groups: scramblesToResultsGroups(\n          internalScramblesToWcifScrambles(e.id, r.scrambleSets)\n        ),\n      })),\n    })),\n    // TODO: make sure that only one tnoodle was used, then add an explicit field for that?\n    scrambleProgram: wcif.scrambleProgram,\n    resultsProgram: `Scrambles Matcher ${version}`,\n  };\n};\n\nexport const internalWcifToWcif = wcif => ({\n  // We only alter the scrambles, so make them right wrt the WCIF.\n  ...wcif,\n  events: wcif.events.map(e => ({\n    ...e,\n    rounds: e.rounds.map(r => ({\n      ...r,\n      scrambleSets: internalScramblesToWcifScrambles(e.id, r.scrambleSets),\n    })),\n  })),\n});\n\nexport const importWcif = wcif => {\n  // Perform a few changes such as sorting the events, and extracting scrambles\n  // sheets.\n\n  wcif = updateIn(wcif, ['events'], sortWcifEvents);\n  let all = flatMap(\n    flatMap(wcif.events, e => e.rounds),\n    r => r.scrambleSets || []\n  );\n  uniqueScrambleSetId =\n    all.length === 0 ? 1 : Math.max(...all.map(s => s.id)) + 1;\n\n  let scrambleSheet = {\n    id: uniqueScrambleUploadedId,\n    competitionName: `${uniqueScrambleUploadedId}: Scrambles for ${wcif.name}`,\n    generationUrl: 'unknown',\n    generationDate: 'unknown',\n    version: 'unknown',\n    sheets: [],\n  };\n\n  wcif = {\n    ...wcif,\n    events: wcif.events.map(e => ({\n      ...e,\n      rounds: e.rounds.map(r => {\n        let sheets = (r.scrambleSets || []).map((set, index) => {\n          let internalSet = wcifScrambleToInternal(\n            e.id,\n            parseActivityCode(r.id).roundNumber,\n            scrambleSheet.competitionName,\n            set,\n            index\n          );\n          if (['333fm', '333mbf'].includes(e.id)) {\n            internalSet = splitMultiFmAsWcif(internalSet);\n            scrambleSheet.sheets.push(...internalSet);\n          } else {\n            scrambleSheet.sheets.push(internalSet);\n          }\n          return internalSet;\n        });\n        return {\n          ...r,\n          scrambleSets: flatMap(sheets, s => s),\n        };\n      }),\n    })),\n  };\n  let extractedSheets = [];\n  if (scrambleSheet.sheets.length !== 0) {\n    uniqueScrambleUploadedId++;\n    extractedSheets.push(scrambleSheet);\n  }\n\n  // Return an element to add to \"uploadedscrambles\", and the processed wcif.\n  return [wcif, extractedSheets];\n};\n","import { flatMap, updateIn, groupBy, sortBy } from './utils';\nimport { parseActivityCode } from './wcif';\nimport { getUniqueScrambleSetId } from './import-export-wcif';\nimport { formatById } from './formats';\nimport { eventNameById } from './events';\n\n// The WCIF defines the following fields:\n// { id, scrambles: [], extraScrambles: [] }\n// Internally we want to store a couple more information:\n// {\n//   sheetName: String, title: String, generatedAttemptNumber: null|Integer,\n//   eventId: String, roundNumber: Integer\n// }\n// This will let us easily (automatically) match and display scrambles in the WCIF.\n// Keeping in mind we'll need to support loading scrambles from the uploaded WCIF!\nconst tnoodleSheetsToInternal = (filename, sheets) =>\n  sheets.map(sheet => ({\n    id: getUniqueScrambleSetId(),\n    scrambles: sheet.scrambles || [],\n    extraScrambles: sheet.extraScrambles || [],\n    title: sheet.title,\n    sheetName: filename,\n    generatedAttemptNumber: sheet.generatedAttemptNumber,\n    eventId: sheet.event,\n    roundNumber: sheet.round,\n  }));\n\nexport const wcifScrambleToInternal = (\n  eventId,\n  roundNumber,\n  sheetName,\n  set,\n  index\n) => ({\n  id: set.id,\n  scrambles: set.scrambles || [],\n  extraScrambles: set.extraScrambles || [],\n  title: `${eventNameById(\n    eventId\n  )} - Round ${roundNumber} - Set ${prefixForIndex(index)}`,\n  sheetName: sheetName,\n  eventId: eventId,\n  roundNumber: roundNumber,\n});\n\nexport const splitMultiFmAsWcif = set => {\n  let attemptNumber = 1;\n  // Split the scramble to have one object per attempt (will be useful later ;))\n  return set.scrambles.map(sequence => ({\n    ...set,\n    id: getUniqueScrambleSetId(),\n    scrambles: [sequence],\n    title: `${set.title} Attempt ${attemptNumber}`,\n    attemptNumber: attemptNumber,\n    generatedAttemptNumber: attemptNumber++,\n  }));\n};\n\nconst splitMultiFm = scramble => {\n  let attemptNumber = 1;\n  // Split the scramble to have one object per attempt (will be useful later ;))\n  return scramble.scrambles.map(sequence => ({\n    ...scramble,\n    scrambles: [sequence],\n    title: `${scramble.title} Attempt ${attemptNumber}`,\n    scrambleSetId: `${scramble.scrambleSetId}-a${attemptNumber}`,\n    generatedAttemptNumber: attemptNumber++,\n  }));\n};\n\nconst scrambleSetsForRound = (usedScramblesId, round, uploadedScrambles) => {\n  // We don't want to overwrite existing scrambles,\n  // so for all rounds *without* scramble we:\n  //   - for all scramble in uploadedScrambles (in order they were uploaded):\n  //     - look for a set of matching (event, round number)\n  // This way if we ever upload multiple sets of scramble for the same round\n  // we just assign the first one (as the others are likely extra scrambles used\n  // in rounds we can't figure out programatically !).\n  // We also want to return a new WCIF as the wcif passed is most likely taken\n  // from a React state.\n  const { eventId, roundNumber } = parseActivityCode(round.id);\n  let firstMatchingSheets = [];\n  uploadedScrambles.find(up => {\n    firstMatchingSheets = up.sheets.filter(\n      s =>\n        !usedScramblesId.includes(s.id) &&\n        s.eventId === eventId &&\n        s.roundNumber === roundNumber\n    );\n    return firstMatchingSheets.length !== 0;\n  });\n  // We don't actually need to update the usedScramblesId, because we never try to\n  // get the same eventId/roundNumber again, so usedScramblesId only need to\n  // contain the scrambles in use before the autoAssign thing.\n  if (['333fm', '333mbf'].includes(eventId)) {\n    // Select scrambles which match the attempt number(s) expected,\n    // and assign the attemptNumber from the generated number\n    let numberOfAttempts = formatById(round.format).solveCount;\n    return firstMatchingSheets\n      .filter(s => s.generatedAttemptNumber <= numberOfAttempts)\n      .map(s => ({\n        ...s,\n        attemptNumber: s.generatedAttemptNumber,\n      }));\n  } else {\n    return firstMatchingSheets;\n  }\n};\n\nexport const allScramblesForEvent = (scrambles, eventId, usedIds) =>\n  flatMap(scrambles, scramble =>\n    scramble.sheets.filter(\n      s => s.eventId === eventId && !usedIds.includes(s.id)\n    )\n  );\n\nexport const usedScramblesIdsForEvent = (events, eventId) =>\n  flatMap(\n    flatMap(events.filter(e => e.id === eventId), e =>\n      flatMap(e.rounds, r => r.scrambleSets)\n    ),\n    s => s.id\n  );\n\nexport const updateMultiAndFm = scrambles =>\n  flatMap(scrambles, s =>\n    s.event === '333fm' || s.event === '333mbf' ? splitMultiFm(s) : s\n  );\n\nexport const transformUploadedScrambles = uploadedJson => {\n  const updater = sheets =>\n    tnoodleSheetsToInternal(uploadedJson.competitionName, sheets);\n  return updateIn(uploadedJson, ['sheets'], updater);\n};\n\n// 65 is the char code for 'A'\nexport const prefixForIndex = index => String.fromCharCode(65 + index);\n\nexport const internalScramblesToWcifScrambles = (eventId, scrambles) => {\n  if (scrambles.length === 0) return scrambles;\n  if (eventId === '333mbf') {\n    // For all attempts, we want to push each of the scramble sequences to\n    // their corresponding groups.\n    let scramblesByAttempt = groupBy(scrambles, s => s.attemptNumber);\n    let sheets = [];\n    Object.keys(scramblesByAttempt)\n      .sort()\n      .forEach(number =>\n        scramblesByAttempt[number].forEach((sheet, groupIndex) => {\n          if (groupIndex >= sheets.length) {\n            // Create a sheet for group\n            sheets.push({\n              id: sheet.id,\n              scrambles: [...sheet.scrambles],\n              extraScrambles: [],\n            });\n          } else {\n            // Push the attempt to the group\n            sheets[groupIndex].scrambles.push(...sheet.scrambles);\n          }\n        })\n      );\n    return sheets;\n  } else if (eventId === '333fm') {\n    // We can't track yet in the WCIF which scramble was for witch attempt,\n    // so let's just sort them by attempt id and combine them in one\n    // scramble sheet.\n    // There is usually only one group for FM, the only case where we would\n    // like more scramble than expected is when something terrible happened\n    // and an extra was needed.\n    return [\n      {\n        id: scrambles[0].id,\n        scrambles: flatMap(\n          sortBy(scrambles, s => s.attemptNumber),\n          s => s.scrambles\n        ),\n        extraScrambles: [],\n      },\n    ];\n  }\n  return scrambles.map(set => ({\n    id: set.id,\n    scrambles: set.scrambles,\n    extraScrambles: set.extraScrambles,\n  }));\n};\n\nexport const autoAssignScrambles = (wcif, uploadedScrambles) => {\n  let usedScrambleIdsByEvent = {};\n  wcif.events.forEach(e => {\n    usedScrambleIdsByEvent[e.id] = usedScramblesIdsForEvent(wcif.events, e.id);\n  });\n  return {\n    ...wcif,\n    events: wcif.events.map(e => ({\n      ...e,\n      rounds: e.rounds.map(r => ({\n        ...r,\n        scrambleSets:\n          r.scrambleSets.length === 0\n            ? scrambleSetsForRound(\n                usedScrambleIdsByEvent[e.id],\n                r,\n                uploadedScrambles\n              )\n            : r.scrambleSets,\n      })),\n    })),\n  };\n};\n\nexport const clearScrambles = wcif => ({\n  ...wcif,\n  events: wcif.events.map(e => ({\n    ...e,\n    rounds: e.rounds.map(r => ({\n      ...r,\n      scrambleSets: [],\n    })),\n  })),\n});\n\nexport const scramblesToResultsGroups = scrambles =>\n  scrambles.map((sheet, index) => ({\n    group: prefixForIndex(index),\n    scrambles: sheet.scrambles,\n    extraScrambles: sheet.extraScrambles || [],\n  }));\n","import React, { Fragment } from 'react';\nimport Grid from '@material-ui/core/Grid';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Typography from '@material-ui/core/Typography';\nimport { Droppable, Draggable } from 'react-beautiful-dnd';\nimport { styled } from '@material-ui/styles';\n\nimport { prefixForIndex } from '../../logic/scrambles';\n\nconst DNDList = styled(List)({\n  minHeight: '100px',\n});\n\nconst getItemStyle = (isDragging, draggableStyle) => ({\n  // styles we need to apply on draggables\n  ...draggableStyle,\n\n  ...(isDragging && {\n    background: 'rgb(235,235,235)',\n  }),\n});\n\nconst ScrambleListHeader = () => (\n  <ListItem>\n    <Grid item xs={6} md={4} lg={2} align=\"center\">\n      <Typography variant=\"subtitle1\">Group</Typography>\n    </Grid>\n    <Grid item xs={6} md={8} lg={10} align=\"right\">\n      <Typography variant=\"subtitle1\">Scramble sheet</Typography>\n    </Grid>\n  </ListItem>\n);\n\nconst ScrambleWithPrefix = ({ prefix, title, subtitle }) => (\n  <Fragment>\n    <Grid item xs={6} md={4} lg={2}>\n      <ListItemText primary={prefix} align=\"center\" />\n    </Grid>\n    <Grid item xs={6} md={8} lg={10} align=\"right\">\n      <ListItemText primary={title} secondary={subtitle} />\n    </Grid>\n  </Fragment>\n);\n\nconst ScrambleItem = ({ title, subtitle }) => (\n  <Grid item xs={12}>\n    <ListItemText primary={title} secondary={subtitle} />\n  </Grid>\n);\n\nconst DraggableScramble = ({ s, index, showPrefix }) => (\n  <Draggable draggableId={s.id} index={index}>\n    {(provided, snapshot) => (\n      <ListItem\n        button\n        ref={provided.innerRef}\n        {...provided.draggableProps}\n        {...provided.dragHandleProps}\n        style={getItemStyle(snapshot.isDragging, provided.draggableProps.style)}\n      >\n        {showPrefix && !snapshot.isDragging ? (\n          <ScrambleWithPrefix\n            prefix={prefixForIndex(index)}\n            title={s.title}\n            subtitle={`From ${s.sheetName}`}\n          />\n        ) : (\n          <ScrambleItem title={s.title} subtitle={`From ${s.sheetName}`} />\n        )}\n      </ListItem>\n    )}\n  </Draggable>\n);\n\nconst ScrambleList = ({ scrambles, holds, round }) => {\n  let showPrefix = holds.startsWith('round') && !round.id.startsWith('333fm');\n  return (\n    <Droppable droppableId={holds}>\n      {(provided, snapshot) => (\n        <DNDList {...provided.droppableProps} ref={provided.innerRef}>\n          {showPrefix && <ScrambleListHeader />}\n          {scrambles.map((s, index) => (\n            <DraggableScramble\n              key={s.id}\n              s={s}\n              index={index}\n              showPrefix={showPrefix}\n            />\n          ))}\n          {false && scrambles.length === 0 && (\n            <ListItem key={0}>No scrambles</ListItem>\n          )}\n          {provided.placeholder}\n        </DNDList>\n      )}\n    </Droppable>\n  );\n};\n\nexport default ScrambleList;\n","import React, { Component } from 'react';\nimport Paper from '@material-ui/core/Paper';\nimport Grid from '@material-ui/core/Grid';\nimport Typography from '@material-ui/core/Typography';\nimport { DragDropContext } from 'react-beautiful-dnd';\n\nimport ScrambleList from '../../Scrambles/ScrambleList';\nimport { groupBy, flatMap } from '../../../logic/utils';\nimport { roundName } from '../../../logic/events';\nimport { formatById } from '../../../logic/formats';\n\nconst attemptFromDroppable = elem => parseInt(elem.droppableId.split('-')[1]);\n\nconst ListForGenericRound = ({ round }) => (\n  <Paper style={{ padding: 16 }}>\n    <Typography variant=\"h5\">Used for round</Typography>\n    <ScrambleList scrambles={round.scrambleSets} holds=\"round\" round={round} />\n  </Paper>\n);\n\nconst ListForAttemptBasedRound = ({ round }) => {\n  const nAttempts = formatById(round.format).solveCount;\n  let attempts = [...Array(nAttempts).keys()].map(i => ++i);\n  return (\n    <Grid container spacing={3}>\n      {attempts.map(index => (\n        <Grid item xs={12} key={index}>\n          <Paper style={{ padding: 16 }}>\n            <Typography variant=\"h5\">Used for attempt {index}</Typography>\n            <ScrambleList\n              scrambles={round.scrambleSets.filter(\n                s => s.attemptNumber === index\n              )}\n              holds={`round-${index}`}\n              round={round}\n            />\n          </Paper>\n        </Grid>\n      ))}\n    </Grid>\n  );\n};\n\nexport default class RoundPanel extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      availableScrambles: this.props.availableScrambles,\n    };\n  }\n\n  componentDidUpdate(prevProps) {\n    let prevIds = this.state.availableScrambles.map(s => s.id).sort();\n    let newIds = this.props.availableScrambles.map(s => s.id).sort();\n\n    if (newIds.join('') !== prevIds.join('')) {\n      this.setState({\n        availableScrambles: this.props.availableScrambles,\n      });\n    }\n  }\n\n  handleGenericMove = (source, destination) => {\n    const { round, attachScramblesToRound } = this.props;\n    const { availableScrambles } = this.state;\n    // Whatever we do, we just need to update the parent state\n    let scrambles =\n      source.droppableId === 'available'\n        ? availableScrambles\n        : round.scrambleSets;\n    let scramble = scrambles.splice(source.index, 1)[0];\n\n    let destScrambles =\n      destination.droppableId === source.droppableId\n        ? scrambles\n        : destination.droppableId === 'round'\n        ? round.scrambleSets\n        : availableScrambles;\n\n    // Insert the scramble to the new array at the correct spot\n    destScrambles.splice(destination.index, 0, scramble);\n\n    if (\n      destination.droppableId === 'available' &&\n      source.droppableId === 'available'\n    )\n      this.setState({ availableScrambles: destScrambles });\n    else if (destination.droppableId === 'round')\n      attachScramblesToRound(destScrambles, round);\n    else attachScramblesToRound(scrambles, round);\n  };\n\n  handleAttemptBasedMove = (source, destination) => {\n    const { round, attachScramblesToRound } = this.props;\n    const { availableScrambles } = this.state;\n    // Again we just need to update the parent state\n    let scrambles = round.scrambleSets;\n    // Group round's scrambles based on attempt number\n    let scramblesByAttempt = groupBy(scrambles, s => s.attemptNumber);\n    let scramble = null;\n    scramble =\n      source.droppableId === 'available'\n        ? availableScrambles[source.index]\n        : scramblesByAttempt[attemptFromDroppable(source)].splice(\n            source.index,\n            1\n          )[0];\n\n    if (destination.droppableId !== 'available') {\n      let destAttempt = attemptFromDroppable(destination);\n      // update the attempt number\n      scramble.attemptNumber = destAttempt;\n      // if that's the first scramble we move there, the entry won't exist yet\n      scramblesByAttempt[destAttempt] = scramblesByAttempt[destAttempt] || [];\n      // actually move the scramble to the appropriate list\n      scramblesByAttempt[destAttempt].splice(destination.index, 0, scramble);\n    }\n\n    // Concatenate everything for the update\n    scrambles = flatMap(\n      Object.keys(scramblesByAttempt),\n      k => scramblesByAttempt[k]\n    );\n    attachScramblesToRound(scrambles, round);\n  };\n\n  handleScrambleMovement = result => {\n    const { source, destination } = result;\n\n    // dropped outside the list\n    if (!destination) {\n      return;\n    }\n\n    if (\n      source.droppableId.includes('-') ||\n      destination.droppableId.includes('-')\n    )\n      this.handleAttemptBasedMove(source, destination);\n    else this.handleGenericMove(source, destination);\n  };\n\n  render() {\n    const { event, round } = this.props;\n    const { availableScrambles } = this.state;\n    return (\n      <DragDropContext onDragEnd={this.handleScrambleMovement}>\n        <Typography variant=\"h5\" align=\"center\" color=\"textSecondary\">\n          {roundName(event.rounds.length, round)}\n        </Typography>\n        <div style={{ padding: 16 }}>\n          <Grid container spacing={2} justify=\"center\">\n            <Grid item xs={6} align=\"center\">\n              {['333mbf', '333fm'].includes(event.id) ? (\n                <ListForAttemptBasedRound round={round} />\n              ) : (\n                <ListForGenericRound round={round} />\n              )}\n            </Grid>\n            <Grid item xs={6} align=\"center\">\n              <Paper style={{ padding: 16 }}>\n                <Typography variant=\"h5\">Available</Typography>\n                <ScrambleList\n                  scrambles={availableScrambles}\n                  holds=\"available\"\n                  round={round}\n                />\n              </Paper>\n            </Grid>\n          </Grid>\n        </div>\n      </DragDropContext>\n    );\n  }\n}\n","import React from 'react';\nimport Paper from '@material-ui/core/Paper';\nimport Button from '@material-ui/core/Button';\nimport ButtonGroup from '@material-ui/core/ButtonGroup';\nimport Link from '@material-ui/core/Link';\nimport Typography from '@material-ui/core/Typography';\nimport TextField from '@material-ui/core/TextField';\n\nimport { competitionLink } from '../../../logic/wcif';\n\nconst LinkToNewPage = props => {\n  const { block, ...extraProps } = props;\n  return (\n    <Link {...extraProps} target=\"_blank\" rel=\"noreferrer\">\n      {block}\n    </Link>\n  );\n};\n\nconst HelperWithLink = ({ id }) => (\n  <span>\n    The ID is correct if and only if{' '}\n    <LinkToNewPage href={`${competitionLink(id)}`} block=\"this link\" /> opens\n    your competition's page.\n  </span>\n);\n\nconst CompetitionDetailsPanel = props => {\n  const {\n    wcif,\n    downloadWcifAction,\n    downloadResultsJsonAction,\n    classes,\n    uploadCompetitionIdAction,\n  } = props;\n\n  const exportAvailable = wcif.id;\n  // For now allow export even if missing scrambles.\n  // && competitionHasValidScrambles(wcif);\n\n  const handleNameChange = ev => uploadCompetitionIdAction(ev.target.value);\n  return (\n    <Paper className={classes.paper}>\n      <Typography variant=\"h5\" gutterBottom>\n        Competition details\n      </Typography>\n      <form className={classes.mb3} noValidate autoComplete=\"off\">\n        <TextField\n          id=\"outlined-name\"\n          label=\"Competition ID\"\n          value={wcif.id || ''}\n          onChange={handleNameChange}\n          helperText={<HelperWithLink id={wcif.id} />}\n          margin=\"normal\"\n          variant=\"outlined\"\n        />\n      </form>\n      <Typography paragraph>\n        When you have made sure your competition ID is correct and all your\n        rounds have the correct scrambles, you can get the export you want\n        below.\n      </Typography>\n      <ButtonGroup\n        color=\"primary\"\n        aria-label=\"outlined primary button group\"\n        disabled={!exportAvailable}\n      >\n        <Button onClick={downloadWcifAction}>Get WCIF</Button>\n        <Button onClick={downloadResultsJsonAction}>Get results JSON</Button>\n      </ButtonGroup>\n    </Paper>\n  );\n};\n\nexport default CompetitionDetailsPanel;\n","import React from 'react';\nimport Paper from '@material-ui/core/Paper';\nimport Button from '@material-ui/core/Button';\nimport Grid from '@material-ui/core/Grid';\nimport Typography from '@material-ui/core/Typography';\nimport FreeBreakfastIcon from '@material-ui/icons/FreeBreakfast';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport classnames from 'classnames';\n\nconst MatchingScramblesPanel = ({\n  assignAction,\n  clearAction,\n  uploadAction,\n  classes,\n}) => {\n  return (\n    <Paper className={classes.paper}>\n      <Typography variant=\"h5\" gutterBottom>\n        Matching scrambles to rounds\n      </Typography>\n      <Typography paragraph align=\"justify\">\n        Clicking \"Automatically assign scrambles\" will attempt to automatically\n        detect which scrambles sets belongs to which round. Unlike the workbook\n        assistant, this will attempt to assign unused scrambles only to rounds{' '}\n        <b>without</b> scrambles! Which means that clicking several times the\n        button with the same uploaded scrambles will have no effect.\n        <br />\n        You can check scrambles assignments by browsing through the rounds in\n        the menu. For each round (or each attempt for Multiple Blindfolded and\n        Fewest Moves) you can assign scrambles manually from the unused\n        scrambles in the uploaded scrambles.\n        <br />\n        When everything looks good, get the Results JSON to import the results\n        on the WCA website.\n        <br />\n        Don't forget to set the competition ID if it's not detected!\n      </Typography>\n      <Grid container direction=\"row\" spacing={2}>\n        <Grid item xs={12}>\n          <input\n            accept=\".json\"\n            className={classes.input}\n            id=\"add-scramble-json\"\n            multiple\n            type=\"file\"\n            onChange={uploadAction}\n          />\n          <label htmlFor=\"add-scramble-json\">\n            <Button\n              variant=\"contained\"\n              component=\"span\"\n              color=\"primary\"\n              fullWidth\n              className={classnames(classes.addJsonButton)}\n            >\n              Upload scrambles json\n            </Button>\n          </label>\n        </Grid>\n        <Grid item xs={6}>\n          <Button\n            variant=\"outlined\"\n            color=\"primary\"\n            fullWidth\n            className={classes.button}\n            onClick={assignAction}\n          >\n            <FreeBreakfastIcon className={classes.extendedIcon} />\n            Automatically assign scrambles\n          </Button>\n        </Grid>\n        <Grid item xs={6}>\n          <Button\n            variant=\"outlined\"\n            color=\"secondary\"\n            fullWidth\n            className={classes.button}\n            onClick={clearAction}\n          >\n            <DeleteIcon className={classes.extendedIcon} />\n            Clear scrambles assignments\n          </Button>\n        </Grid>\n      </Grid>\n    </Paper>\n  );\n};\n\nexport default MatchingScramblesPanel;\n","import React, { useState, Fragment } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Card from '@material-ui/core/Card';\nimport CardHeader from '@material-ui/core/CardHeader';\nimport CardContent from '@material-ui/core/CardContent';\nimport CardActionArea from '@material-ui/core/CardActionArea';\nimport IconButton from '@material-ui/core/IconButton';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport Typography from '@material-ui/core/Typography';\nimport Collapse from '@material-ui/core/Collapse';\nimport clsx from 'clsx';\n\nconst useStyles = makeStyles(theme => ({\n  expand: {\n    transform: 'rotate(0deg)',\n    transition: theme.transitions.create('transform', {\n      duration: theme.transitions.duration.shortest,\n    }),\n  },\n  expandOpen: {\n    transform: 'rotate(180deg)',\n  },\n  card: {\n    marginBottom: theme.spacing(2),\n  },\n  list: {\n    maxHeight: 200,\n    overflowY: 'auto',\n  },\n}));\n\nconst ScrambleFileInfo = ({ scramble }) => {\n  const classes = useStyles();\n  const [expanded, setExpanded] = useState(false);\n\n  function handleExpandClick() {\n    setExpanded(!expanded);\n  }\n\n  return (\n    <Card className={classes.card}>\n      <CardActionArea component=\"span\" onClick={handleExpandClick}>\n        <CardHeader\n          action={\n            <IconButton\n              className={clsx(classes.expand, {\n                [classes.expandOpen]: expanded,\n              })}\n              onClick={handleExpandClick}\n              aria-expanded={expanded}\n              aria-label=\"show more\"\n            >\n              <ExpandMoreIcon />\n            </IconButton>\n          }\n          title={scramble.competitionName}\n          titleTypographyProps={{ variant: 'subtitle1' }}\n          subheader={\n            <Fragment>\n              <Typography variant=\"body2\" component=\"p\" color=\"textSecondary\">\n                Generated with {scramble.version}\n              </Typography>\n              <Typography variant=\"body2\" component=\"p\" color=\"textSecondary\">\n                On {scramble.generationDate}\n              </Typography>\n            </Fragment>\n          }\n        />\n      </CardActionArea>\n      <Collapse in={expanded} timeout=\"auto\" unmountOnExit>\n        <CardContent>\n          <List dense className={classes.list}>\n            {scramble.sheets.map(sheet => (\n              <ListItem key={sheet.id}>\n                <ListItemText primary={sheet.title} />\n              </ListItem>\n            ))}\n          </List>\n        </CardContent>\n      </Collapse>\n    </Card>\n  );\n};\n\nexport default ScrambleFileInfo;\n","import React from 'react';\nimport Typography from '@material-ui/core/Typography';\nimport ScrambleFileInfo from '../../Scrambles/ScrambleFileInfo';\n\nconst UploadedScramblesPanel = ({ uploadedScrambles, classes }) => {\n  return (\n    <div>\n      <Typography variant=\"h5\" gutterBottom>\n        Uploaded JSON files: {uploadedScrambles.length}\n      </Typography>\n      {uploadedScrambles.map(s => (\n        <ScrambleFileInfo scramble={s} key={s.competitionName} />\n      ))}\n    </div>\n  );\n};\n\nexport default UploadedScramblesPanel;\n","import React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Grid from '@material-ui/core/Grid';\nimport {\n  internalWcifToWcif,\n  internalWcifToResultsJson,\n} from '../../../logic/import-export-wcif';\nimport { autoAssignScrambles, clearScrambles } from '../../../logic/scrambles';\nimport CompetitionDetailsPanel from './CompetitionDetailsPanel';\nimport MatchingScramblesPanel from './MatchingScramblesPanel';\nimport UploadedScramblesPanel from './UploadedScramblesPanel';\n\nconst downloadFile = (wcif, exporter, filename = 'wcif.json') => {\n  let blob = new Blob([JSON.stringify(exporter(wcif))], {\n    type: 'application/json',\n  });\n  let blobURL = window.URL.createObjectURL(blob);\n\n  let tmp = document.createElement('a');\n  tmp.href = blobURL;\n  tmp.setAttribute('download', filename);\n  document.body.appendChild(tmp);\n  tmp.click();\n};\n\nconst useStyles = makeStyles(theme => ({\n  input: {\n    display: 'none',\n  },\n  addJsonButton: {\n    marginTop: theme.spacing(2),\n  },\n  extendedIcon: {\n    marginRight: theme.spacing(1),\n  },\n  mb3: {\n    marginBottom: theme.spacing(3),\n  },\n  button: {\n    marginRight: theme.spacing(3),\n  },\n  paper: {\n    padding: theme.spacing(2),\n  },\n}));\n\nconst CompetitionInfo = ({\n  wcif,\n  uploadedScrambles,\n  uploadAction,\n  handleWcifChange,\n  version,\n}) => {\n  const classes = useStyles();\n\n  const actionDownloadWcif = () =>\n    downloadFile(wcif, internalWcifToWcif, `WCIF for ${wcif.id}.json`);\n\n  const actionDownloadResultsJson = () =>\n    downloadFile(\n      wcif,\n      wcif => internalWcifToResultsJson(wcif, version),\n      `Results for ${wcif.id}.json`\n    );\n\n  const actionAssignScrambles = () =>\n    handleWcifChange(autoAssignScrambles(wcif, uploadedScrambles));\n\n  const actionClearScrambles = () => handleWcifChange(clearScrambles(wcif));\n\n  const uploadCompetitionIdAction = id => handleWcifChange({ ...wcif, id: id });\n\n  return (\n    <Grid container spacing={3}>\n      <Grid item xs={12}>\n        <CompetitionDetailsPanel\n          downloadWcifAction={actionDownloadWcif}\n          downloadResultsJsonAction={actionDownloadResultsJson}\n          uploadCompetitionIdAction={uploadCompetitionIdAction}\n          classes={classes}\n          wcif={wcif}\n        />\n      </Grid>\n      <Grid item xs={12}>\n        <MatchingScramblesPanel\n          assignAction={actionAssignScrambles}\n          uploadAction={uploadAction}\n          clearAction={actionClearScrambles}\n          classes={classes}\n        />\n      </Grid>\n      <Grid item xs={12}>\n        <UploadedScramblesPanel\n          uploadedScrambles={uploadedScrambles}\n          classes={classes}\n        />\n      </Grid>\n    </Grid>\n  );\n};\n\nexport default CompetitionInfo;\n","import React, { Component } from 'react';\n\nimport Typography from '@material-ui/core/Typography';\nimport Drawer from '@material-ui/core/Drawer';\nimport Grid from '@material-ui/core/Grid';\nimport CompetitionMenu from './CompetitionMenu/CompetitionMenu';\nimport RoundPanel from './RoundPanel/RoundPanel';\nimport CompetitionInfo from './CompetitionInfo/CompetitionInfo';\nimport { flatMap, updateIn } from '../../logic/utils';\nimport { parseActivityCode } from '../../logic/wcif';\nimport { getUniqueScrambleUploadedId } from '../../logic/import-export-wcif';\nimport {\n  updateMultiAndFm,\n  transformUploadedScrambles,\n  allScramblesForEvent,\n  usedScramblesIdsForEvent,\n} from '../../logic/scrambles';\n\nimport { version } from '../../../package.json';\n\nexport default class Competition extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      wcif: props.wcif,\n      selectedRoundId: null,\n      uploadedScrambles: props.uploadedScrambles,\n    };\n  }\n\n  componentDidMount() {\n    window.addEventListener('beforeunload', this.handleOnBeforeUnload);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('beforeunload', this.handleOnBeforeUnload);\n  }\n\n  handleOnBeforeUnload = ev => {\n    ev.preventDefault();\n    ev.returnValue = '';\n  };\n\n  // It's worth noting we only handle one competition over the life of the component,\n  // therefore no componentDidUpdate is necessary.\n  // To upload scrambles for another competition the user would just refresh the page.\n\n  uploadNewScramble = ev => {\n    let reader = new FileReader();\n\n    reader.onload = e => {\n      // TODO: some check we're facing well formatted scrambles\n      this.setState(state => {\n        let newScramble = JSON.parse(e.target.result);\n        // Manually assign some id, in case someone uses same name for zip\n        // but with different scrambles.\n        newScramble.competitionName = `${getUniqueScrambleUploadedId()}: ${\n          newScramble.competitionName\n        }`;\n        newScramble = updateIn(newScramble, ['sheets'], updateMultiAndFm);\n        newScramble = transformUploadedScrambles(newScramble);\n        return {\n          wcif: {\n            ...state.wcif,\n            scrambleProgram: newScramble.version,\n          },\n          uploadedScrambles: [...state.uploadedScrambles, newScramble],\n        };\n      });\n    };\n\n    reader.onerror = e => {\n      alert(\"Couldn't load the JSON scrambles file\");\n    };\n\n    if (ev.target.files.length > 0) reader.readAsText(ev.target.files[0]);\n  };\n\n  attachScramblesToRound = (scrambles, round) => {\n    const { wcif } = this.state;\n    let { eventId } = parseActivityCode(round.id);\n    let eventIndex,\n      roundIndex = null;\n    let event = wcif.events.find((e, index) => {\n      eventIndex = index;\n      return e.id === eventId;\n    });\n    event.rounds.find((r, index) => {\n      roundIndex = index;\n      return r.id === round.id;\n    });\n    this.setState({\n      wcif: updateIn(wcif, ['events', eventIndex, 'rounds', roundIndex], r => ({\n        ...r,\n        scrambleSets: scrambles,\n      })),\n    });\n  };\n\n  handleWcifChange = wcif => this.setState({ wcif });\n\n  setSelectedRound = id => this.setState({ selectedRoundId: id });\n\n  render() {\n    const { wcif, selectedRoundId, uploadedScrambles } = this.state;\n    // const { handleWcifUpdate } = this.props;\n    const rounds = flatMap(wcif.events, e => e.rounds);\n    let availableScrambles = [];\n    let round = null;\n    let event = null;\n    if (selectedRoundId) {\n      round = rounds.find(r => r.id === selectedRoundId);\n      let { eventId } = parseActivityCode(round.id);\n      event = wcif.events.find(e => e.id === eventId);\n      let used = usedScramblesIdsForEvent(wcif.events, event.id);\n      availableScrambles = allScramblesForEvent(\n        uploadedScrambles,\n        event.id,\n        used\n      );\n    }\n    return (\n      <div style={{ display: 'flex' }}>\n        <Drawer\n          variant=\"permanent\"\n          style={{ width: 250, zIndex: 1 }}\n          PaperProps={{ style: { width: 250 } }}\n        >\n          <div style={{ minHeight: 64 }} />\n          <div style={{ overflowY: 'auto' }}>\n            <CompetitionMenu\n              events={wcif.events}\n              setSelectedRound={this.setSelectedRound}\n            />\n          </div>\n        </Drawer>\n        <div style={{ padding: 16, flexGrow: 1 }}>\n          <Grid container spacing={2}>\n            <Grid item xs={12}>\n              <Typography variant=\"h4\" align=\"center\">\n                {wcif.name}\n              </Typography>\n            </Grid>\n            <Grid item xs={12}>\n              {round ? (\n                <RoundPanel\n                  event={event}\n                  round={round}\n                  availableScrambles={availableScrambles}\n                  attachScramblesToRound={this.attachScramblesToRound}\n                />\n              ) : (\n                <CompetitionInfo\n                  wcif={wcif}\n                  uploadedScrambles={uploadedScrambles}\n                  uploadAction={this.uploadNewScramble}\n                  handleWcifChange={this.handleWcifChange}\n                  version={version}\n                />\n              )}\n            </Grid>\n          </Grid>\n        </div>\n      </div>\n    );\n  }\n}\n","import { sum } from './utils';\n\nexport const decodeMbldResult = value => {\n  if (value <= 0) return { solved: 0, attempted: 0, centiseconds: value };\n  const missed = value % 100;\n  const seconds = Math.floor(value / 100) % 1e5;\n  const difference = 99 - (Math.floor(value / 1e7) % 100);\n  const solved = difference + missed;\n  const attempted = solved + missed;\n  const centiseconds = seconds === 99999 ? null : seconds * 100;\n  return { solved, attempted, centiseconds };\n};\n\nexport const encodeMbldResult = ({ solved, attempted, centiseconds }) => {\n  if (centiseconds <= 0) return centiseconds;\n  const missed = attempted - solved;\n  const dd = 99 - (solved - missed);\n  const seconds = Math.round(\n    (centiseconds || 9999900) / 100\n  ); /* 99999 seconds is used for unknown time. */\n  return dd * 1e7 + seconds * 1e2 + missed;\n};\n\nconst timeInSecToValue = resultString =>\n  Math.round(parseFloat(resultString) * 100);\n\nconst timeInMinutesToValue = resultString => {\n  let [min, rest] = resultString.split(':');\n  min = parseInt(min);\n  const centisec = timeInSecToValue(rest);\n  return min * 6000 + centisec;\n};\n\nexport const meanFromAttempts = attempts => {\n  return attempts.some(a => a < 0)\n    ? -1\n    : Math.round(sum(attempts) / attempts.length);\n};\n\nexport const timeToValue = (resultString, asMove = false) => {\n  switch (resultString) {\n    case 'DNF':\n      return -1;\n    case 'DNS':\n      return -2;\n    default:\n      if (!resultString) {\n        return 0;\n      } else if (asMove) {\n        return parseInt(resultString);\n      } else if (resultString.includes(':')) {\n        return timeInMinutesToValue(resultString);\n      } else {\n        return timeInSecToValue(resultString);\n      }\n  }\n};\n","import { registrantIdFromAttributes } from './wcif';\nimport { timeToValue, meanFromAttempts } from './results';\nimport { roundTypeFromCellName } from './roundtypes';\nimport { countryById } from './countries';\n\nconst formatStringToId = {\n  'Format: best of 1': '1',\n  'Format: best of 2': '2',\n  'Format: best of 3': '3',\n  'Format: mean of 3': 'm',\n  'Format: average of 5': 'a',\n  'Format: average of 5 (removing best and worst)': 'a',\n};\n\nconst expectedNumberOfAttemptsByFormat = {\n  '1': 1,\n  '2': 2,\n  '3': 3,\n  m: 3,\n  a: 5,\n};\n\n// First two rows contain the competition name and irrelevant information.\n// Third row is these headers\n//[\"#\", \"Name\", \"Country\", \"WCA id\", \"Gender\", \"Date of birth\", ...]\nexport const personWcifFromRegistrationXlsx = sheet =>\n  sheet.splice(0, 3) &&\n  sheet.map(person => ({\n    registrantId: parseInt(person[0]),\n    name: person[1],\n    wcaUserId: null,\n    countryIso2: countryById(person[2]).iso2,\n    wcaId: person[3] || null,\n    gender: person[4],\n    birthdate: person[5],\n    // We actually don't need to fill this to post results.\n    registration: {},\n    email: null,\n    avatar: null,\n    roles: [],\n    assignments: [],\n    personalBests: [],\n  }));\n\nconst attemptsFromResultRow = (eventId, formatId, row) => {\n  let maxAttempts = expectedNumberOfAttemptsByFormat[formatId];\n  if (eventId === '333mbf') {\n    return [...Array(maxAttempts).keys()].map(index => ({\n      // For MBF there is a 4 column offset for the person,\n      // then each result takes 4 columns.\n      result: parseInt(row[7 + index * 4]),\n    }));\n  } else {\n    let attempts = row\n      .slice(4, 4 + maxAttempts)\n      .filter(a => a)\n      .map(a => ({\n        result: timeToValue(a, eventId === '333fm'),\n      }));\n    // Fillup to expected number of attempts.\n    // Not necessary but useful to export to results JSON.\n    while (attempts.length !== maxAttempts) attempts.push({ result: 0 });\n    return attempts;\n  }\n};\n\nconst bestForRow = (eventId, formatId, row) => {\n  let maxAttempts = expectedNumberOfAttemptsByFormat[formatId];\n  if (formatId === '1') {\n    // Then there is no \"best\" column\n    return eventId === '333mbf'\n      ? parseInt(row[7])\n      : timeToValue(row[4], eventId === '333fm');\n  } else {\n    // Use extra offset for the \"best\" column\n    return eventId === '333mbf'\n      ? parseInt(row[4 + maxAttempts * 4])\n      : timeToValue(row[4 + maxAttempts], eventId === '333fm');\n  }\n};\n\nconst avgForRow = (eventId, formatId, row) => {\n  if (eventId === '333mbf') return 0;\n  // also get the average for the best of 3 format:\n  // the only events which can use it are 3bf, 4bf, 5bf, and 3mbf.\n  // Except for 3mbf, we recognize the average.\n  if (['3', 'm', 'a'].includes(formatId)) {\n    let maxAttempts = expectedNumberOfAttemptsByFormat[formatId];\n    if (formatId === 'a') {\n      // 5 would return the WR marker for the best.\n      // 6 would return the worst.\n      return timeToValue(row[7 + maxAttempts]);\n    } else {\n      // For FM mo3, the value doesn't need to be taken as moves!\n      // 5 would return the WR marker for the best.\n      let avgDetected = timeToValue(row[6 + maxAttempts]);\n      if (!avgDetected && eventId === '333bf') {\n        // Let's compute the mean\n        let attempts = attemptsFromResultRow(eventId, formatId, row);\n        if (attempts.length !== 3)\n          throw new Error(\n            `Can't compute mean, detected only ${attempts.length} attempts`\n          );\n        avgDetected = meanFromAttempts(attempts.map(a => a.result));\n      }\n      return avgDetected;\n    }\n  }\n\n  return 0;\n};\n\n// First row: round name\n// Second row: format name\n// Third row: time format\n// Fourth row:\n//   [\"Position\", \"Name\", \"Country\", \"WCA id\", \"1\", \"2\", \"3\", \"4\", \"5\", \"Best\", \"WR\", \"Worst\", \"Average\", \"WR\"]\n// or for multi:\n//   [\"Position\", \"Name\", \"Country\", \"WCA id\", \"tried\", \"solved\", \"seconds\", \"score 1\", \"WR\"]\nexport const roundWcifFromXlsx = (persons, eventId, roundNumber, sheet) => {\n  let roundFormat = formatStringToId[sheet[1][0]];\n  let roundType = roundTypeFromCellName(sheet[0][0]);\n  if (!roundFormat)\n    throw new Error(`Couldn't get format from string \"${sheet[1][0]}\"`);\n  if (!roundType)\n    throw new Error(`Couldn't get roundTypeId from string \"${sheet[0][0]}\"`);\n  sheet.splice(0, 4);\n  return {\n    advancementCondition: null,\n    id: `${eventId}-r${roundNumber}`,\n    roundTypeId: roundType.id,\n    cutoff: null,\n    format: roundFormat,\n    results: sheet\n      .filter(row => row[1])\n      .map(row => ({\n        ranking: parseInt(row[0]),\n        personId: registrantIdFromAttributes(\n          persons,\n          row[1],\n          row[2],\n          row[3] || null\n        ),\n        attempts: attemptsFromResultRow(eventId, roundFormat, row),\n        // these are *not* in the WCIF, but will make our life easier to export\n        // to results json!\n        best: bestForRow(eventId, roundFormat, row),\n        average: avgForRow(eventId, roundFormat, row),\n      })),\n    scrambleSetCount: 0,\n    scrambleSets: [],\n    timeLimit: null,\n  };\n};\n","import React, { Fragment } from 'react';\nimport Button from '@material-ui/core/Button';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport { signIn } from '../../logic/auth';\n\nexport const CompetitionsList = ({ competitions, importFromCompetition }) => (\n  <List>\n    {competitions.length === 0 ? (\n      <ListItem>\n        <ListItemText>You have no upcoming competitions to manage</ListItemText>\n      </ListItem>\n    ) : (\n      competitions.map(competition => (\n        <ListItem\n          key={competition.id}\n          button\n          onClick={() => importFromCompetition(competition.id)}\n        >\n          <ListItemText>{competition.name}</ListItemText>\n        </ListItem>\n      ))\n    )}\n  </List>\n);\n\nexport const CompetitionsSection = ({\n  competitions,\n  importFromCompetition,\n}) => (\n  <Fragment>\n    {competitions ? (\n      <CompetitionsList\n        competitions={competitions}\n        importFromCompetition={importFromCompetition}\n      />\n    ) : (\n      <Button\n        variant=\"outlined\"\n        component=\"span\"\n        color=\"secondary\"\n        onClick={signIn}\n      >\n        Sign in with the WCA\n      </Button>\n    )}\n  </Fragment>\n);\n","import React, { useState } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Button from '@material-ui/core/Button';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Grid from '@material-ui/core/Grid';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Paper from '@material-ui/core/Paper';\nimport Tab from '@material-ui/core/Tab';\nimport Tabs from '@material-ui/core/Tabs';\nimport Typography from '@material-ui/core/Typography';\nimport XLSX from 'xlsx';\nimport {\n  personWcifFromRegistrationXlsx,\n  roundWcifFromXlsx,\n} from '../../logic/xlsx-utils';\nimport { CompetitionsSection } from './CompetitionsList';\n\n//import tmpWcif from '../../wcifresults.json';\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    padding: theme.spacing(4),\n  },\n  input: {\n    display: 'none',\n  },\n  tabContent: {\n    padding: theme.spacing(2),\n  },\n}));\n\nconst loadSheetIntoWcif = (wcif, name, jsonSheet) => {\n  // This function strongly assumes that 'Registration' is the first sheet...\n  if (name === 'Registration') {\n    wcif.name = jsonSheet[0][0];\n    wcif.shortName = wcif.name;\n    wcif.persons = personWcifFromRegistrationXlsx(jsonSheet);\n  } else {\n    // Cubecomps export numbers for round identification, CubingChina exports\n    // the roundTypeId.\n    let eventId = name.split('-')[0];\n    let event = wcif.events.find(e => e.id === eventId);\n    if (!event) {\n      event = {\n        id: eventId,\n        rounds: [],\n        competitorLimit: null,\n        qualification: null,\n      };\n      wcif.events.push(event);\n    }\n    let roundNumber = event.rounds.length + 1;\n    event.rounds.push(\n      roundWcifFromXlsx(wcif.persons, eventId, roundNumber, jsonSheet)\n    );\n  }\n};\n\nconst xlsxOptions = {\n  header: 1,\n  raw: false,\n  blankrows: false,\n};\n\nconst handleXlsxUploadChange = (updater, event) => {\n  const reader = new FileReader();\n  const rABS = !!reader.readAsBinaryString;\n\n  reader.onload = e => {\n    const wb = XLSX.read(e.target.result, { type: rABS ? 'binary' : 'array' });\n    const sheetNames = wb.SheetNames;\n    const wcif = {\n      // Unfortunately this is not included in the XLSX :(\n      id: null,\n      name: '<undefined>',\n      shortName: '<undefined>',\n      schedule: [],\n      events: [],\n      persons: [],\n    };\n    sheetNames.forEach(name =>\n      loadSheetIntoWcif(\n        wcif,\n        name,\n        XLSX.utils.sheet_to_json(wb.Sheets[name], xlsxOptions)\n      )\n    );\n    updater(wcif);\n  };\n\n  reader.onerror = e => alert(\"Couldn't load the JSON file\");\n\n  if (rABS) reader.readAsBinaryString(event.target.files[0]);\n  else reader.readAsArrayBuffer(event.target.files[0]);\n};\n\nconst handleFileUploadChange = (updater, event) => {\n  let reader = new FileReader();\n\n  reader.onload = e => updater(JSON.parse(e.target.result));\n\n  reader.onerror = e => alert(\"Couldn't load the JSON file\");\n\n  reader.readAsText(event.target.files[0]);\n};\n\nconst Loading = () => <CircularProgress color=\"secondary\" />;\n\nconst ImportWCIF = ({\n  handleWcifJSONLoad,\n  importFromCompetition,\n  competitions,\n  loading,\n  signedIn,\n}) => {\n  const classes = useStyles();\n  const [tabValue, setTabValue] = useState(signedIn ? 'wca' : 'xlsx');\n\n  // Dirty hack to preload given WCIF\n  //handleWcifJSONLoad(tmpWcif);\n  return (\n    <Grid container justify=\"center\">\n      <Grid item xs={12} md={8} lg={7} xl={6} className={classes.root}>\n        <Grid container direction=\"column\" spacing={3}>\n          <Grid item>\n            <Typography variant=\"h2\" component=\"h1\" align=\"center\">\n              Scrambles Matcher\n            </Typography>\n          </Grid>\n          <Grid item>\n            <Typography>\n              {`This tool enables you to assign sets of JSON scrambles generated by\n              TNoodle to a WCIF.`}\n            </Typography>\n          </Grid>\n          <Grid item>\n            <Typography variant=\"h5\" gutterBottom>\n              Get started\n            </Typography>\n            <Paper elevation={1}>\n              <Tabs\n                variant=\"fullWidth\"\n                value={tabValue}\n                onChange={(event, value) => setTabValue(value)}\n              >\n                <Tab label=\"XLSX file\" value=\"xlsx\" />\n                <Tab label=\"WCA import\" value=\"wca\" />\n                <Tab label=\"WCIF file\" value=\"wcif\" />\n              </Tabs>\n              <div className={classes.tabContent}>\n                {tabValue === 'wca' && (\n                  <Grid container direction=\"column\" spacing={2}>\n                    <Grid item>\n                      <Typography>\n                        {`Start by importing any competition you manage from the WCA website.`}\n                      </Typography>\n                    </Grid>\n                    <Grid item align=\"center\">\n                      {loading ? (\n                        <Loading />\n                      ) : (\n                        <CompetitionsSection\n                          competitions={competitions}\n                          importFromCompetition={importFromCompetition}\n                        />\n                      )}\n                    </Grid>\n                    <Grid item>\n                      <Typography variant=\"caption\">\n                        {`This option will only work if you used a scoretaking platform that\n                          saves the results in the WCIF on the WCA website (e.g. WCA Live).`}\n                      </Typography>\n                    </Grid>\n                  </Grid>\n                )}\n                {tabValue === 'wcif' && (\n                  <Grid container direction=\"column\" spacing={2}>\n                    <Grid item>\n                      <Typography>\n                        {`Start by importing a JSON file with an existing WCIF.`}\n                      </Typography>\n                    </Grid>\n                    <Grid item align=\"center\">\n                      <input\n                        accept=\".json\"\n                        className={classes.input}\n                        id=\"button-wcif\"\n                        multiple\n                        type=\"file\"\n                        onChange={ev =>\n                          handleFileUploadChange(handleWcifJSONLoad, ev)\n                        }\n                      />\n                      <label htmlFor=\"button-wcif\">\n                        <Button\n                          component=\"span\"\n                          variant=\"outlined\"\n                          color=\"primary\"\n                          className={classes.button}\n                        >\n                          Upload WCIF\n                        </Button>\n                      </label>\n                    </Grid>\n                  </Grid>\n                )}\n                {tabValue === 'xlsx' && (\n                  <Grid container direction=\"column\" spacing={2}>\n                    <Grid item>\n                      <Typography>\n                        {`Start by importing a results spreadsheet (e.g. created by Cubecomps or\n                          Cubing China).`}\n                      </Typography>\n                    </Grid>\n                    <Grid item align=\"center\">\n                      <input\n                        accept=\".xlsx\"\n                        className={classes.input}\n                        id=\"button-xlsx\"\n                        multiple\n                        type=\"file\"\n                        onChange={ev =>\n                          handleXlsxUploadChange(handleWcifJSONLoad, ev)\n                        }\n                      />\n                      <label htmlFor=\"button-xlsx\">\n                        <Button\n                          component=\"span\"\n                          variant=\"outlined\"\n                          color=\"primary\"\n                          className={classes.button}\n                        >\n                          Upload XLSX\n                        </Button>\n                      </label>\n                    </Grid>\n                  </Grid>\n                )}\n              </div>\n            </Paper>\n          </Grid>\n          <Grid item>\n            <Typography variant=\"caption\">\n              <Typography\n                variant=\"caption\"\n                component=\"span\"\n                color=\"error\"\n                style={{ fontWeight: 'bold' }}\n              >\n                Note:\n              </Typography>\n              {` there is currently no check whatsoever on the imported data. If\n                you upload incomplete results, or the wrong file on the wrong\n                place, the application will simply crash. If you refresh the page,\n                you will have to start over.`}\n            </Typography>\n          </Grid>\n          <Grid item>\n            <Typography variant=\"h5\" gutterBottom>\n              Description\n            </Typography>\n            <Typography paragraph>\n              {`You are most likely used to using the Workbook Assistant (WA).\n                For competition where everything went well and you just have\n                a single, comprehensive JSON scrambles file, using this should be\n                almost like using the WA.`}\n            </Typography>\n            <Typography paragraph>\n              {`If you have had to edit manually some scrambles JSON because of\n                Multiple Blindfolded, or if you have had to combine multiple\n                scrambles JSONs, read on! Here is a non exhaustive list of\n                differences:`}\n            </Typography>\n            <Typography variant=\"h6\">Additions</Typography>\n            <List disablePadding>\n              <ListItem disableGutters>\n                <ListItemText\n                  primary={`\"Better\" scrambles matching`}\n                  secondary={`\n                    The WA re-assigns automatically scrambles each time you upload a\n                    separate scrambles JSON. Even if you already matched a round to\n                    its corresponding set in the already uploaded scrambles.\n                    Scrambles Matcher assigns on-demand, and will only try to\n                    associate rounds without scrambles to newly imported scrambles.\n                  `}\n                />\n              </ListItem>\n              <ListItem disableGutters>\n                <ListItemText\n                  primary={`Better drag and drop for scrambles`}\n                  secondary={`\n                    If you have moved scrambles around in the WA you know\n                    what I'm talking about.\n                  `}\n                />\n              </ListItem>\n              <ListItem disableGutters>\n                <ListItemText\n                  primary={`Native support for attempt-based event`}\n                  secondary={\n                    <span>\n                      {`Namely Multiple Blindfolded and Fewest Moves. When\n                        importing scrambles JSON(s) it will split scramble sheets\n                        for these events into attempt, so that they can be matched\n                        (manually or automatically) to the attempt they have\n                        actually been used for.`}\n                      <br />\n                      {`Especially useful if you had to generate a couple of extra\n                        scrambles for Multiple Blindfolded, or simply if you used\n                        several groups for that event.`}\n                      <br />\n                      {`Then for the results JSON they are grouped together in a\n                        meaningful way for the WCA website.`}\n                    </span>\n                  }\n                />\n              </ListItem>\n              <ListItem disableGutters>\n                <ListItemText\n                  primary={`Lightweight`}\n                  secondary={`\n                    No more 100MB database download, no more Java, just an web page\n                    to load. However this leads to a missing feature (for now), see below.\n                  `}\n                />\n              </ListItem>\n            </List>\n            <Typography variant=\"h6\">Missing feature</Typography>\n            <List disablePadding>\n              <ListItem disableGutters>\n                <ListItemText\n                  primary={`No more newcomers check`}\n                  secondary={`\n                    It does mean you will have to upload\n                    the results to the WCA website first, as it will validate the\n                    list of competitors. Since you can download the Results JSON\n                    even if you don't have assigned scrambles, you should be able to\n                    check newcomers even before going through scrambles assignment.\n                  `}\n                />\n              </ListItem>\n            </List>\n          </Grid>\n        </Grid>\n      </Grid>\n    </Grid>\n  );\n};\n\nexport default ImportWCIF;\n","import React, { Fragment } from 'react';\nimport AppBar from '@material-ui/core/AppBar';\nimport Avatar from '@material-ui/core/Avatar';\nimport Button from '@material-ui/core/Button';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { CubingIconUnofficial } from '../CubingIcon/CubingIcon';\nimport { signIn } from '../../logic/auth';\n\nconst useStyles = makeStyles(theme => ({\n  title: {\n    flexGrow: 1,\n  },\n  titleIcon: {\n    marginRight: theme.spacing(2),\n  },\n  username: {\n    marginRight: theme.spacing(1),\n  },\n}));\n\nconst Header = ({ user }) => {\n  const classes = useStyles();\n  return (\n    <AppBar position=\"sticky\" color=\"primary\">\n      <Toolbar>\n        <Typography variant=\"h6\" className={classes.title}>\n          <CubingIconUnofficial\n            eventId=\"333mts\"\n            className={classes.titleIcon}\n          />\n          Scrambles Matcher\n        </Typography>\n        {user ? (\n          <Fragment>\n            <Typography variant=\"subtitle1\" className={classes.username}>\n              {user.name}\n            </Typography>\n            <Avatar src={user.avatar.thumb_url} />\n          </Fragment>\n        ) : (\n          <Button color=\"inherit\" onClick={signIn}>\n            Sign in with the WCA\n          </Button>\n        )}\n      </Toolbar>\n    </AppBar>\n  );\n};\n\nexport default Header;\n","import React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Snackbar from '@material-ui/core/Snackbar';\nimport SnackbarContent from '@material-ui/core/SnackbarContent';\nimport IconButton from '@material-ui/core/IconButton';\nimport CloseIcon from '@material-ui/icons/Close';\n\nconst useStyles = makeStyles(theme => ({\n  icon: {\n    fontSize: 20,\n  },\n  error: {\n    backgroundColor: theme.palette.error.dark,\n  },\n  message: {\n    display: 'flex',\n    alignItems: 'center',\n  },\n}));\n\nexport default function ErrorBar({ message, clear }) {\n  const classes = useStyles();\n  return (\n    <Snackbar\n      anchorOrigin={{\n        vertical: 'top',\n        horizontal: 'center',\n      }}\n      open={true}\n    >\n      <SnackbarContent\n        className={classes.error}\n        aria-describedby=\"client-snackbar\"\n        message={<span className={classes.message}>{message}</span>}\n        action={[\n          <IconButton\n            key=\"close\"\n            aria-label=\"close\"\n            color=\"inherit\"\n            onClick={clear}\n          >\n            <CloseIcon className={classes.icon} />\n          </IconButton>,\n        ]}\n      />\n    </Snackbar>\n  );\n}\n","import { WCA_ORIGIN } from './wca-env';\n\nexport const getUpcomingManageableCompetitions = userToken => {\n  const oneMonthAgo = new Date(Date.now() - 28 * 24 * 60 * 60 * 1000);\n  const params = new URLSearchParams({\n    managed_by_me: true,\n    start: oneMonthAgo.toISOString(),\n  });\n  return wcaApiFetch(userToken, `/competitions?${params.toString()}`);\n};\n\nexport const getWcif = (userToken, competitionId) =>\n  wcaApiFetch(userToken, `/competitions/${competitionId}/wcif`);\n\nexport const getMe = userToken => wcaApiFetch(userToken, `/me`);\n\nconst wcaApiFetch = (userToken, path, fetchOptions = {}) => {\n  const baseApiUrl = `${WCA_ORIGIN}/api/v0`;\n\n  return fetch(\n    `${baseApiUrl}${path}`,\n    Object.assign({}, fetchOptions, {\n      headers: new Headers({\n        Authorization: `Bearer ${userToken}`,\n        'Content-Type': 'application/json',\n      }),\n    })\n  )\n    .then(response => {\n      if (!response.ok) throw new Error(response.statusText);\n      return response;\n    })\n    .then(response => response.json());\n};\n","import React, { Component } from 'react';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport Competition from '../Competition/Competition';\nimport ImportWCIF from '../ImportWCIF/ImportWCIF';\nimport Header from './Header';\nimport ErrorBar from './Error';\nimport { importWcif } from '../../logic/import-export-wcif';\nimport {\n  getMe,\n  getUpcomingManageableCompetitions,\n  getWcif,\n} from '../../logic/wca-api';\n\nexport default class App extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      wcif: null,\n      uploadedScrambles: [],\n      error: null,\n      user: null,\n      userToken: props.userToken,\n      competitions: null,\n      loading: false,\n    };\n  }\n\n  handleWcifJSONLoad = json => {\n    const [wcif, extractedScrambles] = importWcif(json);\n    this.setState({\n      wcif,\n      uploadedScrambles: extractedScrambles,\n      loading: false,\n    });\n  };\n\n  handleWcifUpdate = wcif => {\n    this.setState({ wcif });\n  };\n\n  importFromCompetition = id => {\n    this.setState({ loading: true });\n    getWcif(this.state.userToken, id)\n      .then(wcif => this.handleWcifJSONLoad(wcif))\n      .catch(error => this.setState({ error: error.message, loading: false }));\n  };\n\n  componentDidMount() {\n    const { userToken } = this.state;\n    if (userToken) {\n      getMe(userToken)\n        .then(user => {\n          this.setState({\n            user: user.me,\n            loading: this.state.competitions === null,\n          });\n        })\n        .catch(error => this.setState({ error: error.message }));\n      getUpcomingManageableCompetitions(userToken)\n        .then(competitions => {\n          console.log(competitions);\n          this.setState({ competitions, loading: false });\n        })\n        .catch(error => this.setState({ error: error.message }));\n    }\n  }\n\n  render() {\n    const {\n      wcif,\n      uploadedScrambles,\n      error,\n      user,\n      competitions,\n      loading,\n    } = this.state;\n    return (\n      <div\n        style={{ display: 'flex', minHeight: '100vh', flexDirection: 'column' }}\n      >\n        <CssBaseline />\n        <Header user={user} />\n        {error && (\n          <ErrorBar\n            message={error}\n            clear={() => this.setState({ error: null })}\n          />\n        )}\n        {wcif ? (\n          <Competition\n            handleWcifUpdate={this.handleWcifUpdate}\n            wcif={wcif}\n            uploadedScrambles={uploadedScrambles}\n          />\n        ) : (\n          <ImportWCIF\n            handleWcifJSONLoad={this.handleWcifJSONLoad}\n            importFromCompetition={this.importFromCompetition}\n            competitions={competitions}\n            loading={loading}\n            signedIn={!!this.state.userToken}\n          />\n        )}\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport 'typeface-roboto';\nimport './wca_data/cubing-icons.css';\nimport { getOauthTokenIfAny } from './logic/auth';\n\nimport App from './components/App/App';\n\nconst userToken = getOauthTokenIfAny();\nReactDOM.render(<App userToken={userToken} />, document.getElementById('root'));\n"],"sourceRoot":""}